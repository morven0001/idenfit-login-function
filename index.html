<script>
  // 1. Hata yakalama ekleyin
  async function sendToken() {
    try {
      const response = await fetch("https://integration.idenfit.com/login?username=zehraauludag@gmail.com&password=Zehra.1992");
      
      if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
      
      const data = await response.json();
      
      // 2. Content-Type header ekleyin
      const webhookResponse = await fetch("https://prod-105.westeurope.logic.azure.com:443/workflows/eeba067314d9496993368d8d9df81730/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=ddjnu7xuAqnFuweilT_exxHGT4tDNJd4Xkh5Ua-oh5c", {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify({ 
          token: data.token,
          timestamp: new Date().toISOString()
        })
      });
      
      console.log("Webhook yanıtı:", await webhookResponse.text());
    } catch (error) {
      console.error("Hata:", error);
    }
  }

  // 3. Sayfa yüklendiğinde çalıştır
  window.onload = sendToken;
</script>
